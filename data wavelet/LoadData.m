waveletExpected = [0.019322079 0.012554984 0.005885306 -0.000671839 -0.007175236 -0.013779409 -0.020660665 -0.027800681 -0.035431087 -0.043570414 -0.052377116 -0.061995585 -0.072623231 -0.084209926 -0.097251996 -0.111736834 -0.127944946 -0.145994306 -0.166607574 -0.189281702 -0.215428412 -0.244654015 -0.277458847 -0.314262152 -0.357333958 -0.403885633 -0.458017558 -0.518104732 -0.587242365 -0.663104713 -0.755634487 -0.84940052 -0.964251816 -1.093648314 -1.243095875 -1.400389194 -1.594273686 -1.793315053 -2.035127163 -2.303975105 -2.602898359 -2.877584457 -3.342795849 -3.69749403 -4.264174461 -4.721249104 -5.551041126 -6.249576569 -7.467254162 -8.349274635 -9.081134796 -10.43216228 -11.62509251 -12.58404732 -14.25887394 -13.99946404 -16.52147865 -15.08329678 -22.10050201 -23.49255371 -45.11600494 -60.86043549 -71.27694702 -63.40471268 -51.55635834 -51.17304611 -117.1867523 -139.7748871 -127.4708786 -64.00489807 0.307118744 60.92036057 55.30944061 18.97298622 1.004962802 3.632177353 25.26402092 41.09282684 44.51229477 26.41497993 18.2532959 10.15377903 8.138824463 9.381646156 7.53448534 6.485860825 6.111604214 5.917312145 5.160083294 4.777605534 4.49775362 3.773621321 3.566401482 2.958048344 2.488067865 2.22142601 2.004015923 1.722438812 1.5282377 1.362329483 1.189235687 1.073856473 0.956122458 0.826020956 0.739469945 0.657148659 0.575150967 0.506319582 0.449510634 0.393026412 0.348900914 0.308705211 0.270048887 0.238370016 0.21120128 0.184916437 0.162525311 0.142909303 0.124751188 0.108941145 0.095040806 0.081943311 0.070494346 0.060263082 0.050690223 0.041966397 0.034001753 0.02643013];

reflectivity = [0 0 -0.002520927 0.059592243 0.032521963 0.008434446 -0.002022612 -0.006541095 -0.049511563 -0.053242601 -0.023340885 0.075489916 0.046341144 -0.015199308 0.005038367 -0.032028176 -0.033388454 0.029626912 0.001579659 -0.009063697 0.029338399 0.045072578 -0.021830905 -0.017165918 0.029578527 0.026469223 -0.01907677 -0.031069955 0.005279546 0.003418616 -0.03532882 0.001278824 0.048091922 0.002750556 -0.017770298 -0.029332971 0.017570078 0.009933985 -0.021025896 0.010027051 0.045213152 -0.072906129 -0.118634954 0.129523009 0.06008108 -0.018997509 -0.018084675 -0.014204856 0.007532171 -0.003569209 0.016254405 0.038737606 -0.002566617 -0.014596152 0.00044549 0.019000856 -0.006007635 -0.016322816 0.022987546 0.010590091 -0.094279639 -0.054811392 0.076088011 0.049001582 -0.008157439 -0.003175833 0.014687344 -0.002280862 -0.00403501 0.028707834 0.01482662 -0.028346112 -0.018132629 0.025048207 -0.021931227 -0.078740984 0.019996254 0.050585765 -0.028898139 -0.018371684 0.028637409 0.043023206 0.017765742 -0.022000557 0.005118215 -0.024489636 -0.067918308 0.04089671 0.052135497 0.01667369 0.000895174 -0.06702695 -0.038905535 -0.002910259 0.035156772 0.049929302 -0.033633523 0.011965918 0.10073629 0.023621002 -0.004663382 -0.02237425 -0.02783395 -0.00974802 0.013776862 0.006818505 -0.014226426 -0.005190856 0.006913296 0.003947558 -0.005754039 -0.061140314 -0.060837295 0.106018879 0.047725294 -0.016418837 0.000495038 0.002823618 -0.001412466 0.015475965 -0.008095371 -0.002916498 0.000733257 -0.02440026 -0.009667861 -0.004929046 0.019568199 0.009577884 -0.019128835 0.004913758 0.028641015 -0.085625783 -0.077046782 0.111775495 0.057768386];

numberOfReflectivitySamples = length(reflectivity)

%2.9533987 6.75019073 5.90670633 -0.843393445 -6.750009 -13.9229641 -17.7197552 -18.98387 -20.6708374 -17.7197552 
seismicTrace = [-20.6708374 -11.81314 9.08389E-05 -5.06304026 -3.79670119 5.063222 14.7666292 20.6710186 16.8742275 2.9533987 -10.969656 -13.9229641 0.8435751 16.0307426 18.98405 10.1241274 -5.06304026 -11.81314 -10.969656 -0.843393445 5.063222 -0.843393445 -10.1239462 -16.8740463 -16.8740463 -8.016348 5.90670633 21.9373589 24.890667 14.7666292 3.79688287 -3.79670119 -6.750009 -8.016348 -13.9229641 -16.0305614 -14.766448 -10.969656 2.9533987 16.0307426 11.8133221 9.08389E-05 -2.10973263 5.063222 13.0774355 18.98405 17.7177124 2.9533987 -8.859833 -13.0772533 -10.969656 9.08389E-05 13.9209194 13.9209194 6.75019073 -2.953217 -16.8740463 -16.0305614 -2.10973263 3.79688287 -2.953217 -13.0772533 -17.7197552 -10.1239462 2.1099143 8.860014 11.8133221 11.8133221 6.75019073 9.08389E-05 -2.10973263 -2.953217 -5.90652466 -8.016348 -6.750009 -2.10973263 -0.843393445 -3.79670119 -5.06304026 -2.10973263 -2.10973263 9.08389E-05 6.75019073 13.0774355 16.8742275 13.9209194 6.75019073 2.9533987 -0.843393445 -2.10973263 -2.10973263 -8.016348 -16.8740463 -23.6241455 -21.9371777 -16.0305614 -8.859833 -6.750009 -5.90652466 -5.90652466 -5.06304026 2.1099143 6.75019073 5.063222 3.79688287 5.90670633 10.1241274 19.8275356 30.7972813 29.9537983 13.9209194 0.8435751 -3.79670119 -5.90652466 -0.843393445 5.90670633 6.75019073 2.9533987 -0.843393445 -0.843393445 2.9533987 5.063222 5.90670633 2.1099143 -3.79670119 -5.90652466 -10.1239462 -16.0305614 -16.8740463 -17.7197552 -22.78066 -24.8904839 -21.9371777 -14.766448 -13.9229641];
%seismicTrace = seismicTrace / max(seismicTrace);

numberOfSeismicTraceSamples = length(seismicTrace)

figure;
hold on;
plot(waveletExpected/max(abs(waveletExpected)));
title('Wavelet expected');
%plot(reflectivity, 'r');
%plot(seismicTrace, 'g');